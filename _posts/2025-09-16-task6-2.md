---
title: "[시계열 분석] 모델링과 평가"
date: 2025-09-16
categories: [한글, 스터디]
layout: post
tags: [TimeSeries, 시계열, ARIMA, ARCH]
permalink: /posts/task6-2/
---

<br>
지난 포스팅에서는 시계열 데이터의 **정상성(Stationarity)**과 전처리 과정을 다루었습니다.  
이번 글에서는 이렇게 정제된 데이터를 활용하여 실제로 예측에 많이 쓰이는 **ARIMA 계열 모델**과 **ARCH/GARCH 모델**, 그리고 최신 딥러닝 기반 접근법까지 간단히 살펴보겠습니다.  

지난 포스팅에서 다룬 Airpassengers data를 그대로 사용합니다. [아직 읽어보지 않으셨다면?](https://snhzyn.github.io/posts/task5-2/) 

---

## 1. ARIMA 모델

### 기본 개념
ARIMA는 시계열 분석에서 가장 오래되고 널리 쓰이는 예측 모델 중 하나입니다. 2017년 Transformer와 같은 딥러닝 모델이 개발되었지만, 여전히 데이터가 적은 경우 ARIMA는 좋은 성능을 보여주고 있습니다. 구모델이지만 시계열 분석의 핵심적인 인사이트를 얻어갈 수 있으므로, 확실히 정리하고 딥러닝 모델로 넘어가면 좋습니다.  

ARIMA의 핵심은 **과거 데이터와 오차항을 활용해 미래 값을 예측한다**는 것입니다.  

- **AR (AutoRegressive, p, 자기회귀)**  
  현재 값이 **과거 값들의 선형 결합**으로 표현됩니다.  
  \[
  y_t = c + \phi_1 y_{t-1} + \phi_2 y_{t-2} + \dots + \epsilon_t
  \]
  비유하자면, 내가 오늘 공부할 시간을 '어제,그제 공부량'으로 추측하는 것을 의미합니다. 

- **MA (Moving Average, q, 이동평균)**  
  현재 값이 **과거 오차항의 선형 결합**으로 설명됩니다. 과거의 오차가 현재에 영향을 미친다고 가정합니다.  
  \[
  y_t = c + \epsilon_t + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + \dots + \theta_q \epsilon_{t-q}
  \]
  비유하자면, 내가 오늘 공부할 시간을 '어제 얼마나 계획에서 벗어났는지'로 추측하는 것을 의미합니다.

- **I (Integrated, 차분)**  
  데이터가 정상성을 만족하도록 **차분(d)**을 취해 추세를 제거합니다.  

- **ARIMA(p,d,q)**  
  AR(p) + I(d) + MA(q)를 결합한 모델로, 실제 시계열 데이터의 **추세, 자기상관, 잡음**을 동시에 다룰 수 있습니다.
  
즉, 위 세 가지(AR, I, MA)를 모두 고려하여 단기적, 장기적 패턴을 동시에 설명하는 모델이 ARIMA 라고 할 수 있겠습니다.  

---

### 파라미터의 의미
ARIMA의 대표적인 파라미터는 아래 세 가지이지만, 파생 모델에 따라 추가적인 파라미터가 붙을 수 있습니다.  
예를 들어 SARIMA의 경우 밑의 p,d,q 외에 P,D,Q,m가 추가적으로 필요합니다. [공식 문서](https://www.statsmodels.org/stable/generated/statsmodels.tsa.arima.model.ARIMA.html)  

여기서는 주요 파라미터만 간략히 설명하겠습니다.  

- `p` : AR 차수 → 과거 몇 시점의 데이터까지 참고할지  
- `d` : 차분 차수 → 몇 번 차분해야 정상성이 확보되는지  
- `q` : MA 차수 → 과거 몇 시점의 오차항을 고려할지  

즉,  
- `p`는 “과거 데이터 기억 길이”  
- `d`는 “추세 제거 횟수”  
- `q`는 “오차 메모리 길이”  
라고 이해하면 쉽습니다.

---

### 파라미터의 추정 - ACF, PCAF
그렇다면 위의 파라미터는 어떤 방식으로 구할 수 있을까요?  

ARIMA의 파라미터는 Auto_ARIMA를 통해 자동으로 최적값을 출력하는 방법도 있지만, 전통적인 방법으로는 Box-Jenkins 방법이 있습니다.  

이는 ACF, PCAF 함수를 보며 초기 파라미터 p,q를 적합시키는 방법입니다. 그러면 Airpassengers 데이터를 통해 분석해보겠습니다.  

```python
import pandas as pd
import numpy as np
from statsmodels.graphics.tsaplots import plot_acf, plot_pacf
import matplotlib.pyplot as plt

ap = pd.read_csv("airline-passengers.csv")    
ap.drop('Month', axis = 1, inplace = True)

# 로그 변환 + 차분
log_transformed = np.log(ap)
diffed = log_transformed.diff().dropna()

# SARIMA 분석을 위해 계절 차분은 진행하지 않았습니다

# ACF / PACF 시각화
fig, ax = plt.subplots(1,2, figsize=(14,4))
plot_acf(diffed, lags=30, ax=ax[0])
plot_pacf(diffed, lags=30, ax=ax[1])
plt.show()
```  

<figure style="text-align: center;">
  <img src="/assets/img/task6-2/ACF&PCAF.png" 
       alt="ACF/PCAF" 
       width="70%" 
       style="display: block; margin: auto;">
  <figcaption><em>airline-passengers: ACF & PCAF</em></figcaption>
</figure>  

위 그래프의 노란 음영 부분은 신뢰구간을 의미하며, 이 구간 밖에 막대가 있는 경우 유의미한 자기상관이 있다고 판단할 수 있습니다.  

먼저 ACF를 보면, Lag 1과 12가 뚜렷하게 신뢰구간 밖에 있음을 확인할 수 있습니다. 





